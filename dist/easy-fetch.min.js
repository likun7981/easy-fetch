!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(e.SimpleFetch={})}(this,function(e){"use strict";var t=Object.assign||function(e){for(var t=1;arguments.length>t;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e};require("isomorphic-fetch");var n=require("qs/lib/stringify"),o=function(){},r={},i=["body","timeout","headers","onSuccess","onComplete","successFilter","onError","onStart"];e.createRequest=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=e.headers,c=void 0===i?{}:i,u=e.credentials,s=e.timeout,f=void 0===s?5e3:s,a=e.onStart,l=void 0===a?r.onStart||o:a,d=e.onComplete,h=void 0===d?r.onComplete||o:d,v=e.onSuccess,p=void 0===v?r.onSuccess||o:v,m=e.onError,y=void 0===m?r.onError||o:m,b=e.successFilter,g=void 0===b?r.successFilter||function(e){return Promise.resolve(e)}:b;f=f||r.timeout;var S=r.headers?t({},r.headers,c):c,E=t({},r,{headers:S});return u&&(E.credentials=u),function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},c=e.indexOf(" ")>0?e.split(/\s+/):["GET",e],u=c[0],s=c[1],a=r.body?t({},r.body,i):i;"GET"!==u&&(E.method=u),a=JSON.parse(JSON.stringify(a)),Object.keys(a).length&&("GET"!==u.toUpperCase()?E.body=JSON.stringify(a):s+="?"+n(a));var d=new Promise(function(e,t){l(),fetch(s,E).then(function(n){if(n.ok){var o=n.headers;g(n).then(function(t){p(t),h(null,t),e({result:t,headers:o})},function(e){y(e),h(e),t(e)}).catch(t)}else{var r=Error(n.statusText);y(r),h(r),t(r)}},function(e){y(e),h(e),t(e)}).catch(t)}),v={};return d=function(e){var t=null,n=new Promise(function(e,n){t=function(e){n(Error(e||"fetch aborted"))}}),o=Promise.race([e,n]);return o.abort=t,o}(d),v.success=function(e){return e="function"==typeof e?e:o,d=d.then(function(t){e(t.result,t.headers)}),v},v.error=function(e){return e="function"==typeof e?e:o,d=d.then(null,function(t){e(t)}),v},v.complete=function(e){return e="function"==typeof e?e:o,d=d.then(function(){e(null,(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).result)},e),v},v.abort=d.abort,v.catch=d.catch,f&&setTimeout(function(){v.abort("fetch timeout")},f),v}},e.globalConfig=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i.forEach(function(t){r[t]=e[t]})},Object.defineProperty(e,"__esModule",{value:!0})});
