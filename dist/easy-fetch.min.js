!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(e.SimpleFetch={})}(this,function(e){"use strict";function t(e){var t=null,n=new Promise(function(e,n){t=function(e){n(Error(e||"fetch aborted"))}}),o=Promise.race([e,n]);return o.abort=t,o}var n=Object.assign||function(e){for(var t=1;arguments.length>t;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e};require("isomorphic-fetch");var o=require("qs/lib/stringify"),r=function(){},i={},c=["body","timeout","headers","onSuccess","onComplete","successFilter","onError","onStart"],u=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},c=e.headers,u=void 0===c?{}:c,s=e.credentials,f=e.timeout,a=void 0===f?5e3:f,l=e.onStart,d=void 0===l?i.onStart||r:l,h=e.onComplete,v=void 0===h?i.onComplete||r:h,p=e.onSuccess,m=void 0===p?i.onSuccess||r:p,y=e.onError,b=void 0===y?i.onError||r:y,g=e.successFilter,S=void 0===g?i.successFilter||function(e){return Promise.resolve(e)}:g;a=a||i.timeout;var E=i.headers?n({},i.headers,u):u,O=n({},i,{headers:E});return s&&(O.credentials=s),function(e){var c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},u=e.indexOf(" ")>0?e.split(/\s+/):["GET",e],s=u[0],f=u[1],l=i.body?n({},i.body,c):c;"GET"!==s&&(O.method=s),l=JSON.parse(JSON.stringify(l)),Object.keys(l).length&&("GET"!==s.toUpperCase()?O.body=JSON.stringify(l):f+="?"+o(l));var h=new Promise(function(e,t){d(),fetch(f,O).then(function(n){if(n.ok){var o=n.headers;S(n).then(function(t){m(t),v(null,t),e({result:t,headers:o})},function(e){b(e),v(e),t(e)}).catch(t)}else{var r=Error(n.statusText);b(r),v(r),t(r)}},function(e){b(e),v(e),t(e)}).catch(t)}),p={};return h=t(h),p.success=function(e){return e="function"==typeof e?e:r,h=h.then(function(t){e(t.result,t.headers)}),p},p.error=function(e){return e="function"==typeof e?e:r,h=h.then(null,function(t){e(t)}),p},p.complete=function(e){return e="function"==typeof e?e:r,h=h.then(function(){e(null,(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).result)},e),p},p.abort=h.abort,p.catch=h.catch,a&&setTimeout(function(){p.abort("fetch timeout")},a),p}},s=u();e.request=s,e.globalConfig=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};c.forEach(function(t){i[t]=e[t]})},e.createRequest=u,Object.defineProperty(e,"__esModule",{value:!0})});
